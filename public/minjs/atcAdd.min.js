"use strict";var arcAdd=new Vue({el:"#add",data:function(){return{options:[{label:"选项1",value:"javascript"},{label:"选项2",value:"css"},{label:"选项3",value:"node"}],select:"",title:"",tips:"",textarea:"",loading:!1}},methods:{clickIcon:function(e){var t=e.target,a=t.className,s=a.slice(-1),i=document.querySelector(".el-textarea textarea"),l=i.selectionStart,n=i.selectionEnd,o=i.value.slice(0,l),r=i.value.slice(n);switch(s){case"B":i.value=o+"****"+r,i.focus(),i.setSelectionRange(l+2,n+2);break;case"I":i.value=o+"**"+r,i.focus(),i.setSelectionRange(l+1,n+1);break;case"L":this.$prompt("请输入链接","提示",{cancelButtonText:"取消",confirmButtonText:"确定",inputPlaceholder:"谷歌||https://google.com"}).then(function(e){var t=e.value,a=t.split("||");i.value=o+"["+a[0]+"]("+a[1]+")"+r});break;case"Q":this.textInsert(">");break;case"O":this.textInsert("1.");break;case"U":this.textInsert("*")}},submit:function(){var e=this;if(this.loading=!0,document.querySelector(".isData")){var t=document.getElementById("dataId").value;this.select&&this.title&&this.tips&&this.textarea&&t?axios.post("/article/updateDeal",{id:t,type:this.select,title:this.title,tips:this.tips,content:this.textarea}).then(function(t){"修改成功"==t.data?(e.$message("修改成功"),location.reload()):e.$message.error("修改错误")}).catch(function(t){e.$message.error("修改错误")}):e.$message({showClose:!0,message:"不能有空的地方",duration:2e3,type:"warning"})}else this.select&&this.title&&this.tips&&this.textarea?axios.post("/article/addDeal",{type:this.select,title:this.title,tips:this.tips,content:this.textarea}).then(function(t){e.loading=!1,"该标题已经存在"==t.data?e.$message({showClose:!0,message:t.data,duration:2e3,type:"warning"}):e.$message({showClose:!0,message:t.data,duration:2e3})}).catch(function(t){e.loading=!1,e.$message({showClose:!0,message:"未知错误",duration:2e3,type:"error"})}):e.$message({showClose:!0,message:"不能有空的地方",duration:2e3,type:"warning"})},beforeUpload:function(e){var t=/image/.test(e.type),a=e.size/1024/1024<2;return t||this.$message.error("上传的必须是图片！"),a||this.$message.error("上传图片大小不能超过 2MB!"),t&&a},uploadSeccuss:function(e){e&&(this.$message("上传成功"),this.textarea+="![图片](/upload/"+e+")")},textInsert:function(e){for(var t=document.querySelector(".el-textarea textarea"),a=t.selectionStart,s=t.selectionEnd,i=t.value.slice(0,a),l=t.value.slice(s),n=this.textarea,o=n.length,r=0,c=[];r<o;){var u=n.indexOf("\n",r+1);if(-1==u)break;r=u,c.push(u)}var d=c.length;if(0==d)this.textarea=e+this.textarea;else{for(var h=0;h<d;h++)if(c[h]>=s)return i=t.value.slice(0,c[h-1]+1),l=t.value.slice(c[h-1]+1),t.value=i+e+l,t.focus(),void t.setSelectionRange(c[h-1]+2,c[h-1]+2);i=t.value.slice(0,c[d-1]+1),l=t.value.slice(c[d-1]+1),t.value=i+e+l,t.focus(),t.setSelectionRange(c[d-1]+2,c[d-1]+2)}}},created:function(){document.querySelector(".isData")&&(this.select=document.getElementById("dataType").value,this.title=document.getElementById("dataTitle").value,this.tips=document.getElementById("dataTips").value,this.textarea=document.getElementById("dataContent").value)}});